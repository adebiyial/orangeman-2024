---
import { slugify } from "../misc/fns";
import Hyperlink from "./Hyperlink.astro";

interface Props {
  toc?: Array<{
    title: string;
    href?: string;
  }>;
}

const { toc } = Astro.props;
---

<aside data-grid>
  <span>â†“ Table of content</span>
  {
    toc && (
      <nav>
        <ul class="toc">
          <li>
            <Hyperlink href={Astro.url.pathname} nounderline>
              <p data-subtitle>Overview</p>
            </Hyperlink>
          </li>
          {toc.map(({ href, title }) => (
            <li>
              <Hyperlink href={`#${slugify(href || title)}`} nounderline>
                <p data-subtitle>{title}</p>
              </Hyperlink>
            </li>
          ))}
        </ul>
      </nav>
    )
  }
</aside>

<style>
  aside {
    position: sticky;
    top: calc(var(--page-top) + 3px);
    white-space: nowrap;
    z-index: 1;
    grid-column: 1;
    height: 0;
    gap: var(--gap-3x);

    > span {
      color: var(--light-gray);
      font-weight: 600;
    }
  }

  nav {
    height: 50vh;
    overflow: scroll;

    .toc {
      list-style: none;
      padding: 0;
      margin: 0;

      a {
        width: 100%;

        &:hover [data-subtitle] {
          color: var(--default-fg);
        }
      }

      [data-subtitle] {
        padding: var(--gap-s) 0;
      }
    }
  }
</style>
